<link rel="import" href="../bower_components/polymer/polymer.html">


<dom-module id="admin-tag">
  <template>
    <style is='custom-style'>
    :host {
      display: block;
      padding: 10px;
      /*width: 450px;*/
    }

    .alert {
      background-color: #eee;
      display:flex;
      margin:0.5em;
      -webkit-box-shadow: -1px 0px 25px -1px rgba(97,97,97,1);
      -moz-box-shadow: -1px 0px 25px -1px rgba(97,97,97,1);
      box-shadow: -1px 0px 25px -1px rgba(97,97,97,1);
      padding: 0 1em;
      justify-content:center;
      max-width: 90%;
    }
    .alert paper-button {
      font-size: 0.8em;
      color: blue;
    }

    paper-card.tagEditor {
      display: block;
      width: 450px;
      border: 1px solid #d2232a;
      padding: 15px 5px 0 25px;
    }

    paper-card.tagEditor paper-input {
      display: inline-block;
      /*width: 40%;*/
      min-width: 300px;
    }
    paper-card.tagEditor paper-dropdown-menu {
      display: inline-block;
      /*width: 40%;*/
      min-width: 100px;
    }
  </style>


    <!-- Initially, the element displays a paper item showing the key information about the tag.  -->

    <template is="dom-if" if="{{!editing}}">
      <!-- <paper-item name='{{tag}}'>{{tag.label}}  ({{tag.type}})</paper-item>    -->
      <paper-card>

        <!-- Might not need name={{tag}} -->
        <paper-item on-tap="editToggle">{{tag.label}}  ({{tag.type}})</paper-item>
      </paper-card>

    </template>

    <!-- Secondary display for editing mode -->
    <template is="dom-if" if="{{editing}}">
      <paper-card class='tagEditor'>
        <paper-input id="tagLabel" value="{{tag.label}}" name="label" label="Label"></paper-input>
        <paper-dropdown-menu label="tag type">
          <paper-listbox class='dropdown-content' selected="{{tag.type}}" attr-for-selected="name" >
            <paper-item name="Collection">Collection</paper-item>
            <paper-item name="Keyword">Keyword</paper-item>
            <paper-item name="Resource Type">Resource Type</paper-item>
            <paper-item name="Topic">Topic</paper-item>
          </paper-listbox>
        </paper-dropdown-menu>
        <div class='card-actions'>
          <div class='alert' id='emptyTagNoteOpen' hidden$="[[!emptyTagNoteOpen]]">
            <p>Please add a label and a type to the tag.</p>
            <paper-button on-tap='hideEmptyTagNote' style='font-size:0.8em;font-decoration:underline;color:blue;'>( ok! )</paper-button>
          </div>
        <div class='card-actions'>
          <paper-button name='deleteTag' on-tap='delete'>Delete Tag</paper-button>
          <paper-button name='submitTag' on-tap='close'>Confirm and Close</paper-button>
        </div>
      </paper-card>




  </template>

  <!-- Firebase document to get / add / edit individual tag  -->


</template>
  <script>
    Polymer({
      is: 'admin-tag',
      properties: {
        tag: {
          type: Object,
          notify: true,
        },
        editing: {
          type: Boolean,
          // notify: true,
          value: false,
        },
        emptyTagNoteOpen: {
          type: Boolean,
          value: false,
        }
      },


      editToggle: function() {
        console.log("toggled Editing");
        if(this.editing) {
          this.editing = false;
        }
        else {
          this.editing = true;
          //when starting to edit, put current state of tag into originalTag for storage (in case of revert)
        }
      },

      close: function() {
        //prompt validation - show error message if no label or type.
        if (!this.tag.label ||  !this.tag.type ) {
          this.emptyTagNoteOpen = true;
          return;
        }
        // otherwise, trigger closing.
        this.editToggle()
        // close triggers the Save function in ssd-tags for the dedicated "newTag" admin-tag.
        this.dispatchEvent(new CustomEvent('save'));

      },

      hideEmptyTagNote: function() {
        this.emptyTagNoteOpen = false;
      },

      delete: function() {
        this.dispatchEvent(new CustomEvent('delete'));
      }


    })
  </script>
</dom-module>
